-- SQL DEVELOPER INTERNSHIP - TASK 4
-- Objective: Use aggregate functions and grouping to summarize data. [cite: 95]

USE ecommerce_db_task4;

-- Query 1: How many customers do we have in total?
-- Demonstrates: COUNT(*)
SELECT COUNT(*) AS TotalCustomers FROM Customers;

-- Query 2: What is the total revenue from all orders?
-- Demonstrates: SUM()
SELECT SUM(TotalAmount) AS TotalRevenue FROM Orders;

-- Query 3: What is the average price of products in the 'Electronics' category?
-- Demonstrates: AVG() with a WHERE clause
SELECT AVG(Price) AS AverageElectronicsPrice FROM Products WHERE Category = 'Electronics';

-- Query 4: How many products are in each category?
-- Demonstrates: GROUP BY with COUNT()
SELECT Category, COUNT(ProductID) AS NumberOfProducts
FROM Products
GROUP BY Category;

-- Query 5: What is the total amount spent by each customer?
-- Demonstrates: GROUP BY with SUM() and ordering the results.
SELECT CustomerID, SUM(TotalAmount) AS TotalSpent
FROM Orders
GROUP BY CustomerID
ORDER BY TotalSpent DESC;

-- Query 6: Which product categories have more than 1 product?
-- Demonstrates: Filtering groups with the HAVING clause. [cite: 101]
SELECT Category, COUNT(ProductID) AS ProductCount
FROM Products
GROUP BY Category
HAVING COUNT(ProductID) > 1;

-- Query 7: Show me the total amount spent by each customer, but only for customers who have spent more than $1000 in total.
-- Demonstrates: A complete query combining GROUP BY, SUM(), and HAVING.
SELECT CustomerID, SUM(TotalAmount) AS TotalSpent
FROM Orders
GROUP BY CustomerID
HAVING SUM(TotalAmount) > 1000
ORDER BY TotalSpent DESC;
